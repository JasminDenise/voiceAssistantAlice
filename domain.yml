version: "3.1"

# categories of things users say
# classes for multiclass classification

intents:
  - greet
  - goodbye
  - bot_challenge
  - inform_booking_details
  - inform_past_booking
  - inform_fallback
  - rebook_yes
  - rebook_no
  - affirm
  - deny

entities:
  - past_bookings
  - time                  # Duckling-extracted (covers day & time)
  - number                # Duckling-extracted (covers guests)
  - cuisine_preferences
  - dietary_preferences
  - past_restaurant_name

responses:
  utter_greet:
    - text: "Hey! How are you?"
    - text: "Hello there :-)"
    - text: "Hi! How can I help you today?"
    - text: "Hi! Let's book you a restaurant."

  utter_goodbye:
    - text: "Bye"
    - text: "Goodbye! Have a great day."

  utter_iamabot:
    - text: "I’m Alice, your restaurant assistant bot."

  utter_ask_past_bookings:
    - text: "Have you had any past bookings?"
    - text: "Have you booked with us before?"

  utter_ask_past_restaurant_name:
    - text: "What was the name of the restaurant you booked before?"
    - text: "Can you tell me the name of the restaurant you previously visited?"

  utter_ask_dietary_preferences:
    - text: "Do you have any dietary preferences? For example, vegetarian or vegan?"
    - text: "Do you have any dietary preferences or restrictions?"

  utter_ask_cuisine_preferences:
    - text: "What kind of cuisine would you like?"
    - text: "What kind of cuisine do you prefer?"

  utter_confirm_booking:
    - text: "Is this okay?"
    - text: "Yes, that's perfect. Is this okay?"

  utter_ask_for_other_options:
    - text: "Do you have any other preferences?"

  utter_booking_canceled:
    - text: "Okay, I have cancelled your booking request."

  utter_booking_slots:
    - text: "So you're booking a {cuisine_preferences} restaurant for {number} guests at {time}, with dietary preference: {dietary_preferences}."

  utter_submit:
    - text: "All done. I hope you enjoy your meal!"
    - text: "Great! I’ve recorded your booking. Enjoy your meal!"

  utter_ask_continue:
    - text: "Are you sure you want to stop the form?"

  utter_default:
    - text: "I'm sorry, I didn't quite understand that. Could you please rephrase?"

slots:
  past_bookings:
    type: bool
    mappings:
      - type: from_intent
        intent: affirm
        value: true
      - type: from_intent
        intent: deny
        value: false

  rebook:
    type: bool
    mappings:
      - type: from_intent
        intent: rebook_yes
        value: true
      - type: from_intent
        intent: rebook_no
        value: false

  past_restaurant_name:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: past_restaurant_name

  time_of_booking:
    type: any
    mappings:
      - type: from_entity
        entity: time

  day_of_booking:
    type: any
    mappings:
      - type: from_entity
        entity: date

  num_of_guests:
    type: any
    mappings:
      - type: from_entity
        entity: number

  dietary_preferences:
    type: text
    mappings:
      - type: from_entity
        entity: dietary_preferences

  cuisine_preferences:
    type: text
    mappings:
      - type: from_entity
        entity: cuisine_preferences

  conversation_turn:
    type: float
    initial_value: 0
    influence_conversation: false
    mappings:
      - type: custom

forms:
  restaurant_form:
    required_slots:
      - past_bookings
      - cuisine_preferences
      - dietary_preferences
      - time_of_booking
      - day_of_booking
      - num_of_guests

actions:
  - action_suggest_restaurant
  - action_track_turn_count
  - action_default_fallback
  - action_ask_if_rebook
  - validate_restaurant_form

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true